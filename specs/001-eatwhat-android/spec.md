# Feature Specification: 吃点啥 Android 应用

**Feature Branch**: `001-eatwhat-android`
**Created**: 2025-12-10
**Status**: Draft
**Input**: 我要开发一个基于jetpack compose的Android客户端程序，这个程序的名称是`吃点啥`，它的高保真原型设计位于 @design\prototype.html ，使用https://github.com/junerver/ComposeHooks 作为状态管理工具，使用 room 进行本地数据库存储，程序的核心点在于菜谱管理、食材管理、roll点系统等

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 随机选菜(Roll点) (Priority: P1)

用户在不知道做什么菜时，可以通过"Roll点"功能随机获得菜谱推荐。用户可以选择菜的数量，也可以进一步指定荤素搭配比例，系统会从菜谱库中随机选择符合条件的菜谱。

**Why this priority**: 这是应用的核心价值主张，解决用户"选择困难"的痛点，是最小可行产品(MVP)的核心功能。

**Independent Test**: 用户打开应用后点击"Roll点"按钮，即可获得随机菜谱推荐，无需任何其他功能即可体验完整价值。

**Acceptance Scenarios**:

1. **Given** 用户首次打开应用，**When** 点击"Roll点"按钮，**Then** 系统随机推荐1个菜谱
2. **Given** 用户选择"3个菜"，**When** 点击"Roll点"按钮，**Then** 系统随机推荐3个不重复的菜谱
3. **Given** 用户选择"4个菜"并配置"2荤1素1汤"，**When** 点击"Roll点"按钮，**Then** 系统推荐2个荤菜、1个素菜、1个汤
4. **Given** 用户选择"3个菜"但未配置荤素比例，**When** 点击"Roll点"按钮，**Then** 系统随机推荐3个菜谱(不限类型)
5. **Given** Roll点结果已显示，**When** 用户点击"重新Roll"，**Then** 系统生成新的随机推荐

---

### User Story 2 - 菜谱管理 (Priority: P1)

用户可以添加、查看、编辑和删除自己的菜谱。每个菜谱包含菜名、类型(荤菜/素菜/汤/主食)、难度、预计时间、自定义标签、食材列表和烹饪步骤。

**Why this priority**: 没有菜谱库，Roll点功能无法工作。这是支撑核心功能的基础数据层。

**Independent Test**: 用户可以独立添加菜谱并查看菜谱列表，验证数据持久化功能。

**Acceptance Scenarios**:

1. **Given** 用户在"我的菜谱"页面，**When** 点击"+"按钮，**Then** 进入添加菜谱页面
2. **Given** 用户填写完整菜谱信息，**When** 点击"保存"，**Then** 菜谱保存成功并显示在菜谱列表中
3. **Given** 用户在添加食材时，**When** 点击食材旁的🏷图标，**Then** 该食材名称被添加为自定义标签
4. **Given** 用户在菜谱列表，**When** 点击某个菜谱，**Then** 显示该菜谱的详细信息(食材、步骤)
5. **Given** 用户在菜谱列表，**When** 选择类型筛选(荤菜/素菜/汤/主食)，**Then** 只显示对应类型的菜谱
6. **Given** 用户添加自定义标签(如"西点"、"炖菜")，**When** 保存菜谱，**Then** 标签与菜谱关联保存

---

### User Story 3 - 备菜清单 (Priority: P2)

用户确认Roll点结果后，系统自动汇总所有选中菜谱的食材，生成备菜清单。用户可以勾选已准备的食材，跟踪备菜进度。

**Why this priority**: 增强用户体验，将"决策"延伸到"执行"阶段，但不影响核心Roll点功能的使用。

**Independent Test**: 用户完成Roll点后点击"就这些了"，即可看到汇总的食材清单并进行勾选操作。

**Acceptance Scenarios**:

1. **Given** 用户看到Roll点结果，**When** 点击"就这些了"，**Then** 进入备菜阶段，显示汇总的食材清单
2. **Given** 多个菜谱包含相同食材，**When** 生成备菜清单，**Then** 相同食材只显示一次
3. **Given** 用户在备菜清单中，**When** 勾选某个食材，**Then** 该食材显示为已完成状态(删除线+半透明)
4. **Given** 用户完成备菜，**When** 点击"开始做菜"，**Then** 跳转到历史记录详情页面

---

### User Story 4 - 历史记录 (Priority: P2)

用户可以查看过往的Roll点记录，包括选择的菜谱、备菜进度等信息。用户可以在历史记录中继续更新备菜状态。

**Why this priority**: 提供数据回顾能力，帮助用户追踪饮食习惯，但不影响核心功能的首次使用。

**Independent Test**: 用户完成至少一次Roll点后，可以在"历史"标签页查看记录。

**Acceptance Scenarios**:

1. **Given** 用户完成Roll点并确认，**When** 进入"历史"页面，**Then** 显示该次记录(时间、菜谱摘要)
2. **Given** 用户在历史列表，**When** 点击某条记录，**Then** 显示该次的详细信息(菜谱、备菜进度)
3. **Given** 用户在历史详情页，**When** 勾选/取消勾选食材，**Then** 备菜进度实时更新并保存
4. **Given** 用户在历史详情页，**When** 点击某个菜谱，**Then** 显示该菜谱的详细信息
5. **Given** 用户在菜谱详情页(从历史进入)，**When** 点击返回，**Then** 返回到历史详情页(而非菜谱列表)

---

### Edge Cases

- 当菜谱库为空时，Roll点功能如何处理？系统应提示用户先添加菜谱
- 当用户配置的荤素数量总和超过总菜数时如何处理？系统应限制可选数量，确保总和不超过总菜数
- 当某个类型的菜谱数量不足时如何处理？系统应从可用菜谱中随机选择，可能无法满足精确配置
- 当用户添加菜谱时未填写必填字段如何处理？系统应验证并提示用户补充信息
- 当用户删除已在历史记录中使用的菜谱时如何处理？历史记录应保留菜谱快照，不受删除影响
- 当应用数据损坏或迁移时如何处理？系统应提供数据导入导出功能(未来扩展)

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系统必须提供Roll点功能，允许用户随机获取菜谱推荐
- **FR-002**: 系统必须支持用户配置Roll点参数(菜的数量、荤素搭配比例)
- **FR-003**: 系统必须支持渐进式配置，用户可以只选择菜数而不指定荤素比例
- **FR-004**: 系统必须提供菜谱管理功能，包括添加、查看、编辑、删除菜谱
- **FR-005**: 系统必须支持菜谱分类(荤菜、素菜、汤、主食)和筛选
- **FR-006**: 系统必须支持自定义标签功能，用户可以为菜谱添加任意标签(如"西点"、"炖菜")
- **FR-007**: 系统必须支持从食材快速创建标签(点击🏷图标)
- **FR-008**: 系统必须记录菜谱的难度(简单/中等/困难)和预计时间
- **FR-009**: 系统必须支持动态添加/删除食材和烹饪步骤
- **FR-010**: 系统必须在用户确认Roll点结果后自动生成备菜清单
- **FR-011**: 系统必须汇总相同食材，避免重复显示
- **FR-012**: 系统必须支持用户勾选已准备的食材，跟踪备菜进度
- **FR-013**: 系统必须保存历史记录，包括Roll点配置、选中的菜谱、备菜状态
- **FR-014**: 系统必须支持用户在历史记录中查看和更新备菜进度
- **FR-015**: 系统必须使用本地数据库持久化所有数据(菜谱、历史记录)
- **FR-016**: 系统必须提供底部导航栏，包含"Roll点"、"菜谱"、"历史"三个主要入口
- **FR-017**: 系统必须支持移动端友好的交互方式(如标签添加使用+按钮和确认按钮)
- **FR-018**: 系统必须正确处理页面导航和返回逻辑(如从历史进入菜谱详情后返回到历史)

### Key Entities

- **菜谱(Recipe)**: 包含菜名、类型(荤菜/素菜/汤/主食)、图标、难度、预计时间、自定义标签列表、食材列表、烹饪步骤列表
- **食材(Ingredient)**: 包含名称、数量、单位(g/ml/个/勺/适量)
- **烹饪步骤(CookingStep)**: 包含步骤序号和描述
- **Roll点配置(RollConfig)**: 包含总菜数、荤菜数、素菜数、汤数
- **Roll点结果(RollResult)**: 包含配置快照、选中的菜谱列表、生成时间、备菜清单
- **备菜清单项(PrepItem)**: 包含食材信息和完成状态(已勾选/未勾选)
- **历史记录(HistoryRecord)**: 包含Roll点结果、备菜进度、时间戳
- **自定义标签(CustomTag)**: 包含标签名称，与菜谱多对多关联

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 用户可以在3次点击内完成一次Roll点操作(打开应用→配置参数→Roll点)
- **SC-002**: 用户可以在2分钟内添加一个完整的菜谱(包含食材和步骤)
- **SC-003**: 系统在500毫秒内完成Roll点计算并显示结果
- **SC-004**: 备菜清单自动汇总食材，用户无需手动整理
- **SC-005**: 历史记录完整保存所有Roll点信息，用户可随时回顾
- **SC-006**: 应用支持离线使用，所有数据本地存储
- **SC-007**: 用户可以通过自定义标签快速分类和检索菜谱
- **SC-008**: 90%的用户操作在3秒内得到响应(页面切换、数据加载)

## Assumptions

- 用户主要在准备做饭前使用应用，使用场景为厨房或家中
- 用户的菜谱库规模在10-100个之间
- 用户每周使用Roll点功能2-5次
- 用户设备运行Android 8.0或更高版本
- 应用无需网络连接，完全离线工作
- 菜谱数据由用户手动输入，不提供在线菜谱库(未来可扩展)
- 食材单位使用常见的中式烹饪单位(克、毫升、个、勺、适量)
- 自定义标签用于个性化分类(如"西点"、"炖菜"、"快手菜"等)

## Out of Scope

以下功能不在本次开发范围内，但可作为未来扩展方向:

- 在线菜谱库和菜谱分享功能
- 食材库存管理和采购清单生成
- 营养成分计算和饮食分析
- 菜谱图片上传和展示
- 多用户账号和数据同步
- 语音输入和智能推荐
- 社交功能(评论、点赞、收藏)
- 数据导入导出和备份功能
